<p align="center">Министерство образования, науки и молодежной политики Республики Коми</p>

<p align="center">ГПОУ "Сыктывкарский политехнический техникум"</p>

<p align="center">Курсовая работа</p>

<p align="center">тема: База данных для спортивной школы</p>

<p align="right"> выполнил </p>
<p align="right">студент 4 курса </p>
<p align="right">414 группы </p>
<p align="right">Лыткин Семён Васильевич</p>

<p align="right">проверил</p>
<p align="right">Пунгин И.В.</p>
<p align="right">дата проверки: </p>

<p align="center">Сыктывкар, 2025</p>

# Задание на курсовую работу по МДК 11.01 "Технология разработки и защиты баз данных"
Специальность: <ins> 09.02.07 "Информационные системы и программирование"  </ins>

Тема курсовой работы: База данных для спортивной школы

Срок представления работы к защите: <ins> 31 марта 2025 года. </ins>

Перечень подлежащих разработке вопросов:

1. Анализ предметной области. Постановка задачи.

    1.1. Описание предметной области и функции решаемых задач.

    1.2. Перечень входных данных.

    1.3. Перечень выходных данных.

    1.4. Ограничения предметной области (если таковые имеются).

    1.5. Взаимодействие с другими программами.

2. Инфологическая (концептуальная) модель базы данных.

    2.1. Выделение информационных объектов.

    2.2. Определение атрибутов объектов.

    2.3. Определение отношений и мощности отношений между объектами.

    2.4. Построение концептуальной модели.

3. Логическая структура БД.

4. Физическая структура базы данных.

5. Реализация проекта в среде конкретной СУБД.

    5.1. Создание таблиц и индексов.

    5.2. Создание представлений и функций.

    5.3. Разработка интерфейса.

    5.4. Назначение прав доступа.

    5.5. Разработка стратегии резервного копирования базы данных.

Руководитель работы __________________ <ins> И. В. Пунгин </ins>

Задание принял к исполнению _______________________________ <ins> Лыткин Семён Васильевич </ins>

## <a id="content">Содержание</a>
1. [Введение](#introduction)
    - [Цель работы](#target)
    - [Задачи работы](#tasks)
2. [Основная часть](#main)
    - [Анализ предметной области. Постановка задачи](#analysis)
    - [Инфологическая (концептуальная) модель базы данных](#infological_model)
    - [Логическая структура БД](#logical_structure)
    - [Физическая структура базы данных](#physical_structure)
    - [Реализация проекта в среде конкретной СУБД](#project_realization)
3. [Заключение](#conclusion)
4. [Список использованных информационных источников](#literature)
5. [Приложения](#applications)

### <a id="introduction">Введение</a>
В современных спортивных школах управление данными играет ключевую роль в обеспечении эффективности и конкурентоспособности. Успешная деятельность требует систематизации информации о спортсменах, тренерах, администраторах, соревнованиях и инвентаре. Ручное ведение учёта уже не способно справляться с растущими объёмами данных, что приводит к ошибкам, потерям времени и снижению качества обслуживания клиентов. Поэтому создание автоматизированной базы данных становится важной задачей для спортивной школы, так как оно обеспечивает быструю обработку данных и повышает точность учёта.
В данной работе рассматривается процесс разработки базы данных для спортивной школы, целью которой является создание надёжного и функционального инструмента для хранения и управления данными о спортсменах, тренерах, инвентаре и соревнованиях. Такой подход позволит улучшить контроль за операциями, сократить временные затраты на обработку информации и повысить общую продуктивность работы организации.

#### <a id="target">Цель работы</a>
### **Цель работы**

Целью данной курсовой работы является разработка базы данных для спортивной школы, которая обеспечит автоматизацию процессов учёта и анализа данных. База данных должна стать надёжным инструментом для хранения и управления информацией о спортсменах, тренерах, соревнованиях и инвентаре. Она должна позволять:

- Вести учёт спортсменов с указанием их ФИО, даты рождения, контактной информации и данных о тренере.
- Регистрировать результаты участия спортсменов в соревнованиях и анализировать их для выявления прогресса и прогнозирования успеха.
- Хранить данные о тренерах, включая их специализацию, контактную информацию и условия сотрудничества.
- Учитывать состояние инвентаря, включая его название, описание, количество и дату последней проверки.
- Формировать аналитические отчёты для принятия стратегических решений, таких как планирование тренировок, закупка инвентаря и участие в соревнованиях.

Кроме того, база данных должна быть масштабируемой, чтобы справляться с ростом объёмов данных, и защищённой, чтобы предотвращать несанкционированный доступ к информации. Эти требования делают разработку базы данных сложной, но крайне важной задачей для современной спортивной школы.


#### <a id="tasks">Задачи работы</a>
Для достижения поставленной цели необходимо решить следующие задачи:
1. **Анализировать деятельность спортивной школы** для выявления основных требований к базе данных и объёма данных, подлежащих хранению и обработке.
2. **Проектировать структуру базы данных**, включающую ключевые таблицы, атрибуты и связи между сущностями, такими как спортсмены, тренеры, администрация, соревнования и инвентарь.
3. **Выбрать и обосновать систему управления базами данных (СУБД)**, которая будет использована для реализации проекта ( или PostgreSQL).
4. **Реализовать структуру базы данных** на выбранной СУБД, включая создание таблиц и связей с помощью SQL-запросов.
5. **Заполнить базу данных тестовыми данными** для проверки работоспособности и корректности структуры.
6. **Разработать и протестировать SQL-запросы** для получения необходимых данных, таких как выборка спортсменов, регистрация участия в соревнованиях и анализ результатов.
7. **Осуществить тестирование базы данных** для проверки корректности выполнения всех операций, целостности данных и функциональности запросов.
8. **Сформулировать выводы и предложения** по дальнейшему развитию и расширению функционала базы данных.

[Вернуться к содержанию](#content)

### <a id="main">Основная часть</a>

#### <a id="analysis">Анализ предметной области. Постановка задачи</a>
1. ### 1. **Описание предметной области и функции решаемых задач**

### **Описание предметной области**

Спортивная школа сталкивается с необходимостью эффективного управления данными о спортсменах, тренерах, соревнованиях и инвентаре. В условиях ограниченных ресурсов и высоких требований к организации спортивных мероприятий автоматизация процессов становится ключевым фактором успеха.

Например, база данных спортивной школы позволяет:
- Учитывать наличие инвентаря на складе и своевременно его пополнять.
- Отслеживать участие спортсменов в соревнованиях и их результаты.
- Хранить данные о тренерах, их специализациях и контактной информации.
- Анализировать статистику спортсменов для улучшения качества обучения и прогнозирования их успеха.

---

### **Интеграция с внешними системами**

Для спортивной школы важна интеграция с:
- **Спортивными платформами**: Для регистрации участников соревнований и отслеживания их результатов.
- **CRM-системами**: Для учёта данных о спортсменах, тренерах и их взаимодействии.
- **Системами аналитики**: Для анализа результатов соревнований, прогнозирования успеха спортсменов и формирования отчётов.
- **Мобильными приложениями**: Для удобного доступа к данным о расписании тренировок, результатах соревнований и состоянии инвентаря.

---

### **Цели автоматизации**

Автоматизация базы данных направлена на решение следующих задач:
- **Устранение ручного ввода данных**: Минимизация человеческого фактора и связанных с этим ошибок.
- **Оптимизация процессов**: Ускорение выполнения операций за счёт автоматизации, таких как регистрация спортсменов, учёт инвентаря и формирование отчётов.
- **Повышение качества обслуживания**: Быстрый доступ к данным и возможность формирования аналитических отчётов.
- **Масштабируемость**: Возможность расширения базы данных при росте объёмов информации, например, при увеличении числа спортсменов или соревнований.

---

### **Ключевые преимущества разработанной базы данных**

1. **Автоматизация учёта**: Полностью исключает ручной ввод данных и минимизирует ошибки.
2. **Аналитические возможности**: Предоставляет инструменты для анализа:
   - Результатов спортсменов.
   - Эффективности тренеров.
   - Состояния инвентаря.
3. **Безопасность данных**: Реализованы механизмы авторизации, разграничения прав и резервного копирования.
4. **Интеграция с внешними системами**: Обеспечивает бесперебойную работу всех бизнес-процессов.
5. **Масштабируемость**: Справляется с ростом объёмов данных за счёт оптимизации и индексации.
---

### Дополнительные примеры использования базы данных


#### Для спортивной школы:
1. **Отслеживание прогресса спортсменов**:
   - Анализ данных о тренировках и соревнованиях позволяет выявить сильные и слабые стороны спортсменов.
   - Это помогает тренерам корректировать планы тренировок.

2. **Оптимизация использования инвентаря**:
   - Отслеживание количества инвентаря и своевременное его пополнение.

---

### Перспективы развития

1. **Добавление мобильного приложения**:
   - Для спортивной школы: доступ к данным о спортсменах и соревнованиях в режиме реального времени.

2. **Расширение аналитических возможностей**:
   - Использование машинного обучения для прогнозирования спроса или успеха спортсменов.

3. **Оптимизация производительности**:
   - Добавление партиционирования таблиц и использования материализованных представлений.
    - **Функции решаемых задач:**

### Описание функционала базы данных для спортивной школы

#### 1. **Учёт инвентаря**
- Ведение подробных данных о каждом элементе инвентаря:
  - **Название**: Название элемента инвентаря.
  - **Описание**: Подробное описание элемента инвентаря.
  - **Количество**: Количество единиц инвентаря на складе.
  - **Фотографии**: Возможность добавления фотографий или других медиафайлов.
- Интеграция с системами контроля запасов:
  - Автоматическое пополнение инвентаря при достижении минимального уровня.
- Хранение информации о поставщиках:
  - Контактные данные и условия сотрудничества.

#### 2. **Регистрация участия в соревнованиях**
- Запись данных об участии спортсменов в соревнованиях:
  - **Дата и время проведения**.
  - **Список участников** и их результаты.
  - **Место проведения**.
- Возможность добавления фотографий или видеоматериалов:
  - Например, наград или сертификатов.
- Анализ данных о соревнованиях:
  - Выявление трендов и прогнозирование успешности спортсменов.
- Интеграция с системами мотивации:
  - Начисление бонусов или наград спортсменам.

#### 3. **Учёт спортсменов**
- Сохранение данных о спортсменах:
  - **ФИО**: Фамилия, имя и отчество спортсмена.
  - **Дата рождения**.
  - **Контактная информация**: Телефон и адрес.
  - **История участия в соревнованиях**.
- Возможность добавления отзывов и оценок тренеров:
  - Для улучшения качества обучения.
- Интеграция с CRM-системами:
  - Формирование персонализированных планов тренировок и рекомендаций.

#### 4. **Учёт тренеров**
- Хранение данных о тренерах:
  - **ФИО**: Фамилия, имя и отчество тренера.
  - **Специализация**: Специализация тренера (например, бокс, легкая атлетика).
  - **Контактная информация**: Телефон и адрес.
- Возможность отслеживания сроков работы тренеров:
  - Качество их подготовки спортсменов.
- Интеграция с системами планирования:
  - Автоматическое распределение тренеров по группам и мероприятиям.

---

### Подробное описание таблиц базы данных

#### 1. **Таблица "Инвентарь"**
| Поле             | Тип данных       | Описание                                   |
|------------------|------------------|-------------------------------------------|
| `id`            | SERIAL PRIMARY KEY | Уникальный идентификатор элемента инвентаря |
| `name`          | VARCHAR(255)     | Название элемента инвентаря                |
| `description`   | TEXT            | Подробное описание                        |
| `quantity`      | INT             | Количество единиц инвентаря               |

#### 2. **Таблица "Соревнования"**
| Поле             | Тип данных       | Описание                                   |
|------------------|------------------|-------------------------------------------|
| `id`            | SERIAL PRIMARY KEY | Уникальный идентификатор соревнования      |
| `name`          | VARCHAR(255)     | Название соревнования                     |
| `event_date`    | TIMESTAMP        | Дата и время проведения                    |
| `location`      | VARCHAR(255)     | Место проведения                          |

#### 3. **Таблица "Спортсмены"**
| Поле             | Тип данных       | Описание                                   |
|------------------|------------------|-------------------------------------------|
| `id`            | SERIAL PRIMARY KEY | Уникальный идентификатор спортсмена        |
| `full_name`     | VARCHAR(255)     | ФИО спортсмена                            |
| `birth_date`    | DATE             | Дата рождения                             |
| `contact_info`  | TEXT             | Контактная информация                     |
| `coach_id`      | INT              | Ссылка на тренера                         |

#### 4. **Таблица "Тренеры"**
| Поле             | Тип данных       | Описание                                   |
|------------------|------------------|-------------------------------------------|
| `id`            | SERIAL PRIMARY KEY | Уникальный идентификатор тренера           |
| `full_name`     | VARCHAR(255)     | ФИО тренера                               |
| `specialization`| VARCHAR(255)     | Специализация тренера                     |
| `contact_info`  | TEXT             | Контактная информация                     |



2. **Перечень входных данных.**
 Для эффективной работы системы необходимы следующие входные данные:

На основе входных данных система должна предоставить следующие выходные данные:

#### 1. **Отчёт по спортсменам**
   - Список спортсменов с их личными данными.
   - Сведения об участии в соревнованиях (история, результаты).
   - Прогресс спортсменов за определённый период (например, улучшение результатов).

#### 2. **Отчёты по соревнованиям**
   - Список соревнований с участниками и результатами.
   - Анализ успешности спортсменов на соревнованиях.
   - Прогнозирование результатов на будущих соревнованиях.

#### 3. **Отчёт по инвентарю**
   - Список инвентаря с текущим количеством.
   - Уведомления о необходимости пополнения инвентаря.
   - Отчёт о состоянии инвентаря (например, повреждения, срок службы).

#### 4. **Отчёт по тренерам**
   - Список тренеров с их специализациями.
   - Количество спортсменов, обучаемых каждым тренером.
   - Результаты спортсменов под руководством каждого тренера.

4. **Ограничения предметной области.** При работе с базой данных могут возникнуть следующие ограничения:
    #### 1. **Ограничение по объёму данных**
- Если количество спортсменов, тренеров, данных о соревнованиях или инвентаре существенно возрастёт, это может негативно сказаться на скорости обработки запросов. Для решения этой проблемы необходимо использовать механизмы оптимизации, такие как:
  - **Индексация таблиц**: Ускоряет выполнение запросов за счёт создания индексов для часто запрашиваемых полей.
  - **Партиционирование таблиц**: Разделение больших таблиц на более мелкие части для улучшения производительности.
  - **Кэширование данных**: Хранение часто используемых данных в памяти для быстрого доступа.
- Например, если количество записей о результатах спортсменов на соревнованиях превышает несколько миллионов строк, это может замедлить работу системы без оптимизации.

#### 2. **Ограничение по доступу**
- Данные, такие как личная информация о спортсменах, результаты соревнований или данные о состоянии инвентаря, должны быть защищены от несанкционированного доступа. Это ограничение требует реализации надёжных механизмов авторизации и разграничения прав пользователей:
  - **Администраторы** должны иметь полный доступ ко всем данным, включая финансовые отчёты и историю изменений.
  - **Тренеры** могут просматривать только данные о своих спортсменах и их результатах.
  - **Спортсмены** могут иметь доступ только к своим личным данным и истории участия в соревнованиях.
- Для обеспечения безопасности рекомендуется использовать протоколы шифрования данных и двухфакторную аутентификацию.

#### 3. **Ограничение по обновлению данных**
- Чтобы избежать потери данных, необходимо разработать систему резервного копирования. Это ограничение предполагает наличие регулярных бэкапов для предотвращения потерь информации в случае технических сбоев:
  - **Логическое резервное копирование**: Создание SQL-дампов для восстановления структуры и данных базы.
  - **Физическое резервное копирование**: Копирование файлов базы данных для восстановления в случае аппаратных сбоев.
  - Рекомендуется настроить автоматическое резервное копирование с использованием cron-заданий (Linux) или планировщика задач (Windows).
- Также важно предусмотреть механизмы блокировки данных во время обновления для предотвращения конфликтов при одновременной записи.

#### 4. **Ограничение по производительности**
- При работе с большими объёмами данных важно учитывать производительность системы:
  - Использование индексов может значительно ускорить выполнение запросов, но также увеличивает нагрузку на сервер при вставке новых данных. Поэтому необходимо тщательно планировать использование индексов.
  - Оптимизация запросов: Избегайте сложных JOIN-операций и используйте денормализацию данных, если это необходимо для повышения производительности.
  - Мониторинг использования ресурсов сервера: Регулярно проверяйте загрузку процессора, оперативной памяти и дискового пространства.
- Например, если база данных хранит данные о результатах всех соревнований за последние 10 лет, запросы на выборку данных могут замедлиться без оптимизации.

#### 5. **Взаимодействие с другими программами**
База данных спортивной школы может взаимодействовать с различными программами и модулями для расширения функциональности и повышения удобства работы:
- **Программа для аналитики**:
  - Для анализа данных и визуализации отчётов можно интегрировать базу данных с аналитическими платформами, такими как Tableau, Power BI или Metabase.
  - Например, можно создавать графики прогресса спортсменов, сравнивать их результаты с прошлыми периодами и прогнозировать успех на будущих соревнованиях.
- **CRM-система**:
  - Для управления контактами спортсменов и тренеров можно интегрировать базу данных с CRM-системами, такими как Bitrix24 или Salesforce.
  - Это позволит автоматизировать рассылку уведомлений о предстоящих соревнованиях или тренировках.
- **Платформа для регистрации участников соревнований**:
  - Интеграция с платформами для регистрации участников (например, Eventbrite или RunSignup) позволит автоматически добавлять данные о спортсменах и их результатах.
- **Мобильное приложение**:
  - Разработка мобильного приложения для спортсменов и тренеров позволит им получать доступ к данным через смартфоны, такие как расписание тренировок, результаты соревнований и состояние инвентаря.

---

### **Дополнительные примеры ограничений**

#### 6. **Ограничение по масштабируемости**
- Если спортивная школа планирует расширяться (например, открывать новые филиалы), необходимо предусмотреть возможность масштабирования базы данных:
  - Использование облачных решений, таких как Amazon RDS или Google Cloud SQL, для автоматического масштабирования.
  - Настройка репликации данных для обеспечения высокой доступности.

#### 7. **Ограничение по конфиденциальности**
- В соответствии с законодательством (например, GDPR или ФЗ-152 в России), необходимо обеспечить защиту персональных данных спортсменов и тренеров:
  - Шифрование данных на уровне базы.
  - Аудит доступа к данным для выявления несанкционированных действий.

#### 8. **Ограничение по аналитическим возможностям**
- Если аналитические запросы становятся слишком сложными, может потребоваться использование специализированных решений:
  - **OLAP-кубы**: Для многомерного анализа данных.
  - **Материализованные представления**: Для ускорения выполнения сложных аналитических запросов.

[Вернуться к содержанию](#content)

#### <a id="infological_model">Инфологическая (концептуальная) модель базы данных</a>
1. **Выделение информационных объектов.**
    - **Спортсмен** - информация о спортсменах, обучающихся в школе.
    - **Тренер** - данные о тренерах, работающих в школе.
    - **Соревнование** - данные о соревнованиях, в которых участвуют спортсмены.
    - **Инвентарь** - информация об инвентаре, используемом в школе.

#### Определение отношений
1. **Тренер - Спортсмен:**
   - **Связь:** один ко многим.
   - **Описание:** Один тренер может обучать множество спортсменов, но каждый спортсмен привязан только к одному тренеру. Это позволяет четко отслеживать, кто за кого отвечает.

2. **Спортсмен - Соревнование:**
   - **Связь:** один ко многим.
   - **Описание:** Один спортсмен может участвовать в множестве соревнований, но каждое соревнование связано с конкретным списком участников.

3. **Инвентарь - Спортсмен:**
   - **Связь:** один ко многим.
   - **Описание:** Один спортсмен может использовать множество единиц инвентаря, но каждая запись об использовании связана с конкретным спортсменом.

3. **Определение отношений и мощности отношений между объектами.**
    - **Тренер - Спортсмен:**
        - **Связь:** один ко многим.
        - **Описание:** Один тренер может обучать множество спортсменов.
    - **Спортсмен - Соревнование:**
        - **Связь:** один ко многим.
        - **Описание:** Один спортсмен может участвовать в множестве соревнований.
    - **Инвентарь - Спортсмен:**
        - **Связь:** один ко многим.
        - **Описание:** Один спортсмен может использовать множество единиц инвентаря.

4. **Построение концептуальной модели.**
    - **Тренер** (ID_тренера, ФИО, специализация, контактная информация), связан с **Спортсмен** (ID_спортсмена, ФИО, дата рождения, контактная информация).
    - **Спортсмен** связан с **Соревнование** (ID_соревнования, название, дата проведения, место проведения).
    - **Инвентарь** (ID_инвентаря, название, описание, количество), связан с **Спортсмен** через отношение "один ко многим".

[Вернуться к содержанию](#content)

#### <a id="logical_structure">Логическая структура базы данных</a>
**Определение таблиц и их атрибутов**
1. **Таблица "Тренеры"**
    - **ID_тренера** (Primary Key) - уникальный идентификатор тренера (целое число).
    - **ФИО** - фамилия, имя и отчество тренера (строка).
    - **Специализация** - специализация тренера (строка).
    - **Контактная информация** - контактные данные тренера (строка).

2. **Таблица "Спортсмены"**
    - **ID_спортсмена** (Primary Key) - уникальный идентификатор спортсмена (целое число).
    - **ФИО** - фамилия, имя и отчество спортсмена (строка).
    - **Дата рождения** - дата рождения спортсмена (дата).
    - **Контактная информация** - контактные данные спортсмена (строка).
    - **ID_тренера** (Foreign Key) - ссылка на тренера спортсмена (целое число).

3. **Таблица "Соревнования"**
    - **ID_соревнования** (Primary Key) - уникальный идентификатор соревнования (целое число).
    - **Название** - название соревнования (строка).
    - **Дата проведения** - дата проведения соревнования (дата).
    - **Место проведения** - место проведения соревнования (строка).

4. **Таблица "Инвентарь"**
    - **ID_инвентаря** (Primary Key) - уникальный идентификатор инвентаря (целое число).
    - **Название** - название инвентаря (строка).
    - **Описание** - описание инвентаря (строка).
    - **Количество** - количество единиц инвентаря (целое число).

[Вернуться к содержанию](#content)


1. **Выбор типов данных**
    - **INT** — используется для целочисленных значений, таких как идентификаторы записей.
    - **VARCHAR(255)** — применяется для хранения текстовых данных переменной длины.
    - **DATE** — используется для хранения дат.

## Оптимизация индексов

Индексы являются ключевым элементом в оптимизации базы данных, так как они позволяют ускорить доступ к данным и облегчают выполнение запросов, таких как поиск, фильтрация и сортировка. Индексы создаются для полей, которые часто участвуют в поисковых запросах, соединениях таблиц и аналитических операциях. В контексте базы данных спортивной школы индексы помогают эффективно управлять данными о спортсменах, тренерах, соревнованиях и инвентаре.

---

### 1. **Первичные ключи**

Первичные ключи автоматически индексируются и обеспечивают быстрый поиск записей. Это особенно важно для таблиц, содержащих уникальные идентификаторы, такие как:
- `ID_спортсмена`
- `ID_тренера`
- `ID_соревнования`
- `ID_инвентаря`

Пример создания первичного ключа для таблицы "Спортсмены":

```sql
CREATE TABLE public.students (
    id SERIAL PRIMARY KEY,
    full_name VARCHAR(255) NOT NULL,
    birth_date DATE NOT NULL,
    contact_info TEXT,
    coach_id INT REFERENCES public.coaches(id) ON DELETE SET NULL
);
```

---

### 2. **Внешние ключи**

Для ускорения запросов, связанных с соединением таблиц, рекомендуется создавать индексы для внешних ключей. Например:

- **Индекс для поля `ID_тренера`** в таблице "Спортсмены", чтобы быстро находить всех спортсменов, обучаемых конкретным тренером:

```sql
CREATE INDEX idx_students_coach ON students (coach_id);
```

- **Индекс для поля `ID_соревнования`** в таблице "Результаты", чтобы быстро находить результаты спортсменов на конкретных соревнованиях:

```sql
CREATE INDEX idx_results_competition ON results (competition_id);
```

---

### 3. **Дополнительные индексы**

Для полей, которые часто используются в фильтрации, сортировке или аналитических запросах, также рекомендуется создавать индексы. Примеры:

- Для поля **Дата проведения** в таблице "Соревнования":

```sql
CREATE INDEX idx_competitions_date ON competitions (event_date);
```

- Для поля **Количество** в таблице "Инвентарь", чтобы быстро находить инвентарь с низким остатком:

```sql
CREATE INDEX idx_inventory_quantity ON inventory (quantity);
```

- Для поля **ФИО** в таблице "Спортсмены", чтобы ускорить поиск спортсменов по имени:

```sql
CREATE INDEX idx_students_name ON students (full_name);
```

---

### 4. **Многоколоночные индексы**

Если запросы часто используют несколько полей одновременно, можно создать многоколоночные индексы. Например:

- **Индекс для полей `Дата рождения` и `ID_тренера`** в таблице "Спортсмены", чтобы быстро находить спортсменов определённого возраста и тренера:

```sql
CREATE INDEX idx_students_birth_coach ON students (birth_date, coach_id);
```

---

### 5. **Частичные индексы**

Частичные индексы создаются только для подмножества данных, что позволяет экономить ресурсы. Например:

- **Индекс для активных спортсменов** (только те, кто участвует в текущих соревнованиях):

```sql
CREATE INDEX idx_active_students ON students (id) WHERE status = 'active';
```

---

### 6. **Индексы для аналитических запросов**

Для аналитических запросов, таких как выявление прогресса спортсменов или анализ результатов соревнований, рекомендуется создавать индексы для полей, используемых в агрегации:

- **Индекс для поля `Результат`** в таблице "Результаты", чтобы ускорить вычисление средних значений:

```sql
CREATE INDEX idx_results_score ON results (score);
```

---

### Примеры использования индексов

#### 1. **Поиск спортсменов по тренеру**

Запрос для поиска всех спортсменов, обучаемых конкретным тренером:

```sql
SELECT * FROM students WHERE coach_id = 1;
```

Индекс `idx_students_coach` значительно ускорит выполнение этого запроса.

---

#### 2. **Анализ результатов соревнований**

Запрос для анализа результатов спортсменов на конкретном соревновании:

```sql
SELECT * FROM results WHERE competition_id = 10 ORDER BY score DESC;
```

Индекс `idx_results_competition` ускорит выборку данных, а индекс `idx_results_score` улучшит сортировку.

---

#### 3. **Отслеживание состояния инвентаря**

Запрос для поиска инвентаря с количеством меньше 10:

```sql
SELECT * FROM inventory WHERE quantity < 10;
```

Индекс `idx_inventory_quantity` позволит быстро найти нужные записи.

---

### Рекомендации по использованию индексов

#### 1. **Планирование индексов**
- Тщательно анализируйте запросы, чтобы определить, какие поля чаще всего используются в фильтрации, соединениях и сортировке.
- Избегайте избыточного создания индексов, так как это увеличивает нагрузку на сервер при вставке новых данных.

#### 2. **Мониторинг производительности**
- Используйте инструменты мониторинга PostgreSQL, такие как `EXPLAIN` и `EXPLAIN ANALYZE`, для анализа выполнения запросов и оптимизации индексов.

#### 3. **Обслуживание индексов**
- Регулярно проверяйте и перестраивайте индексы для предотвращения их фрагментации.
- Удаляйте неиспользуемые индексы, чтобы освободить ресурсы.

---



#### Механизмы хранения
PostgreSQL использует механизм хранения данных, поддерживающий многоверсионность (MVCC), что позволяет эффективно управлять транзакциями и конкурентным доступом к данным. MVCC гарантирует согласованность данных и поддерживает высокий уровень надежности.

#### Параметры хранения
Для повышения производительности можно настроить следующие параметры PostgreSQL:
- **shared_buffers:** Размер памяти, выделяемой для кэширования данных.
- **work_mem:** Размер памяти для операций сортировки и соединений.
- **maintenance_work_mem:** Размер памяти для операций обслуживания, таких как создание индексов.

[Вернуться к содержанию](#content)

#### <a id="project_realization">Реализация проекта в среде конкретной СУБД</a>

![image](https://github.com/user-attachments/assets/25bfcfe8-ce19-41b0-9d7b-df127c1c3dfa)


**Создание таблиц**
Таблицы создаются на основе физической структуры, разработанной в предыдущих разделах. Ниже приводится SQL-код для создания основных таблиц. Каждая таблица содержит первичные ключи, внешние ключи и ограничения целостности.

-- Создание таблицы Администрация
CREATE TABLE public.administration (
    id SERIAL PRIMARY KEY,
    user_id INT UNIQUE REFERENCES public.users(id) ON DELETE CASCADE,
    full_name VARCHAR(255) NOT NULL,
    position VARCHAR(255),
    contact_info TEXT
);

-- Создание таблицы Тренеры
CREATE TABLE public.coaches (
    id SERIAL PRIMARY KEY,
    user_id INT UNIQUE REFERENCES public.users(id) ON DELETE CASCADE,
    full_name VARCHAR(255) NOT NULL,
    specialization VARCHAR(255),
    contact_info TEXT
);

-- Создание таблицы Соревнования
CREATE TABLE public.competitions (
    id SERIAL PRIMARY KEY,
    name VARCHAR(255) NOT NULL,
    event_date TIMESTAMP NOT NULL,
    location VARCHAR(255)
);

-- Создание таблицы Инвентарь
CREATE TABLE public.inventory (
    id SERIAL PRIMARY KEY,
    name VARCHAR(255) NOT NULL,
    description TEXT,
    quantity INT NOT NULL CHECK (quantity >= 0),
    location VARCHAR(255)
);

-- Создание таблицы Движения_инвентаря
CREATE TABLE public.inventory_movements (
    id SERIAL PRIMARY KEY,
    inventory_id INT REFERENCES public.inventory(id) ON DELETE CASCADE,
    student_id INT REFERENCES public.students(id) ON DELETE SET NULL,
    coach_id INT REFERENCES public.coaches(id) ON DELETE SET NULL,
    movement_type VARCHAR(50),
    destination VARCHAR(255),
    movement_date VARCHAR,
    CONSTRAINT inventory_movements_movement_type_check CHECK (movement_type = ANY (ARRAY['issued', 'returned', 'transferred']))
);

-- Создание таблицы Расписание
CREATE TABLE public.schedule (
    id SERIAL PRIMARY KEY,
    student_id INT REFERENCES public.students(id) ON DELETE CASCADE,
    coach_id INT REFERENCES public.coaches(id) ON DELETE SET NULL,
    class_date TIMESTAMP NOT NULL,
    location VARCHAR(255)
);

-- Создание таблицы Участники_соревнований
CREATE TABLE public.student_competitions (
    id SERIAL PRIMARY KEY,
    student_id INT REFERENCES public.students(id) ON DELETE CASCADE,
    competition_id INT REFERENCES public.competitions(id) ON DELETE CASCADE,
    inventory_id INT REFERENCES public.inventory(id) ON DELETE SET NULL
);

-- Создание таблицы Студенты
CREATE TABLE public.students (
    id SERIAL PRIMARY KEY,
    user_id INT UNIQUE REFERENCES public.users(id) ON DELETE CASCADE,
    full_name VARCHAR(255) NOT NULL,
    birth_date DATE NOT NULL,
    contact_info TEXT,
    registration_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    completed_lessons INT DEFAULT 0
);

-- Создание таблицы Пользователи
CREATE TABLE public.users (
    id SERIAL PRIMARY KEY,
    username VARCHAR(255) NOT NULL UNIQUE,
    password_hash VARCHAR(255) NOT NULL,
    role VARCHAR(50),
    CONSTRAINT users_role_check CHECK (role = ANY (ARRAY['coacher', 'administration', 'student']))
);

-- Создание функции для предотвращения самокоучинга
CREATE FUNCTION public.prevent_self_coaching() RETURNS TRIGGER AS $$
BEGIN
    IF EXISTS (
        SELECT 1 
        FROM coaches c
        JOIN students s ON c.user_id = s.user_id
        WHERE c.id = NEW.coach_id AND s.id = NEW.student_id
    ) THEN
        RAISE EXCEPTION 'Тренер не может быть студентом для самого себя';
    END IF;
    RETURN NEW;
END;
$$ LANGUAGE plpgsql;

-- Создание триггера для предотвращения самокоучинга
CREATE TRIGGER check_self_coaching
BEFORE INSERT OR UPDATE ON public.schedule
FOR EACH ROW
EXECUTE FUNCTION public.prevent_self_coaching();



### **Разработка запросов**

Запросы для управления базой данных и получения информации помогут обеспечить работу спортивной школы. Примеры запросов включают:

---

#### 1. **Вывод списка всех спортсменов с указанием их тренера и даты рождения:**

```sql
SELECT s.full_name AS Спортсмен, c.full_name AS Тренер, s.birth_date AS Дата_рождения
FROM students s
JOIN coaches c ON s.coach_id = c.id;
```

---

#### 2. **Запрос для получения информации о результатах спортсменов на последних соревнованиях:**

```sql
SELECT s.full_name AS Спортсмен, c.name AS Соревнование, r.score AS Результат, c.event_date AS Дата
FROM results r
JOIN students s ON r.student_id = s.id
JOIN competitions c ON r.competition_id = c.id
ORDER BY c.event_date DESC;
```

---

#### 3. **Запрос для анализа количества участников на каждом соревновании:**

```sql
SELECT c.name AS Соревнование, COUNT(r.student_id) AS Количество_участников
FROM competitions c
LEFT JOIN results r ON c.id = r.competition_id
GROUP BY c.name
ORDER BY Количество_участников DESC;
```

---

#### 4. **Запрос для анализа популярности категорий инвентаря (по количеству использований):**

```sql
SELECT i.name AS Инвентарь, COUNT(u.usage_id) AS Количество_использований
FROM inventory i
LEFT JOIN usage u ON i.id = u.inventory_id
GROUP BY i.name
ORDER BY Количество_использований DESC;
```

---

#### 5. **Запрос для получения общего количества медалей, завоёванных спортсменами за период:**

```sql
SELECT s.full_name AS Спортсмен, COUNT(r.medal) AS Количество_медалей
FROM results r
JOIN students s ON r.student_id = s.id
WHERE r.medal IS NOT NULL AND c.event_date BETWEEN '2024-01-01' AND '2024-12-31'
GROUP BY s.full_name
ORDER BY Количество_медалей DESC;
```

---

#### 6. **Запрос для анализа средней успеваемости спортсменов у каждого тренера:**

```sql
SELECT c.full_name AS Тренер, AVG(r.score) AS Средний_результат
FROM results r
JOIN students s ON r.student_id = s.id
JOIN coaches c ON s.coach_id = c.id
GROUP BY c.full_name
ORDER BY Средний_результат DESC;
```

---

#### 7. **Запрос для проверки состояния инвентаря (низкий остаток):**

```sql
SELECT name AS Инвентарь, quantity AS Количество
FROM inventory
WHERE quantity < 10;
```

---

#### 8. **Запрос для получения списка спортсменов, зарегистрированных на конкретное соревнование:**

```sql
SELECT s.full_name AS Спортсмен
FROM students s
JOIN results r ON s.id = r.student_id
JOIN competitions c ON r.competition_id = c.id
WHERE c.name = 'Чемпионат города';
```

---

### **Примечания по использованию запросов**

1. **Оптимизация запросов:**
   - Убедитесь, что для полей, используемых в `JOIN`, `WHERE` и `GROUP BY`, созданы индексы.
   - Используйте инструменты мониторинга PostgreSQL, такие как `EXPLAIN` и `EXPLAIN ANALYZE`, для анализа производительности запросов.

2. **Тестирование запросов:**
   - Перед внедрением запросов в рабочую среду протестируйте их на тестовых данных, чтобы убедиться в корректности результатов.

3. **Расширение функционала:**
   - При необходимости добавьте дополнительные фильтры или параметры для более гибкого анализа данных.





### **Интерфейс**

Интерфейс для взаимодействия с базой данных можно создать с использованием веб-технологий (например, HTML, CSS, JavaScript) или инструментов построения интерфейсов в Python, таких как Tkinter. Основные функции интерфейса должны включать:

#### 1. **Отображение данных о спортсменах, тренерах и соревнованиях:**
   - Список спортсменов с указанием их тренеров.
   - История участия спортсменов в соревнованиях.
   - Отчёт о результатах соревнований за определённый период.

#### 2. **Добавление и обновление данных:**
   - Формы для добавления новых спортсменов, тренеров и регистрации результатов соревнований.
   - Возможность редактирования существующих записей.

#### 3. **Фильтрация и поиск:**
   - Поиск спортсменов по ФИО, дате рождения или тренеру.
   - Фильтрация соревнований по названию, дате или месту проведения.

---

### **Назначение прав доступа**

Назначение прав доступа в PostgreSQL выполняется с помощью ролей и команд **GRANT** и **REVOKE**. Для спортивной школы можно выделить следующие роли:
- **Администратор:** Полные права на создание, изменение и удаление данных.
- **Тренер:** Может добавлять и обновлять данные о спортсменах и их результатах, но не имеет прав на удаление записей.
- **Сотрудник:** Может только просматривать информацию о спортсменах, тренерах и соревнованиях.

Пример назначения прав доступа:

```sql
-- Создание ролей
CREATE ROLE Администратор WITH LOGIN PASSWORD 'password';
CREATE ROLE Тренер WITH LOGIN PASSWORD 'password';
CREATE ROLE Сотрудник WITH LOGIN PASSWORD 'password';

-- Назначение прав для каждой роли
GRANT ALL PRIVILEGES ON ALL TABLES IN SCHEMA public TO Администратор;
GRANT SELECT, INSERT, UPDATE ON students, coaches, competitions, results TO Тренер;
GRANT SELECT ON students, coaches, competitions TO Сотрудник;
```

---

### **Резервное копирование**

Для защиты данных от сбоев и потерь необходимо разработать стратегию регулярного резервного копирования. Для PostgreSQL основными методами являются:

#### 1. **Логическое резервное копирование с помощью `pg_dump`:**
```bash
pg_dump -U username -F c -b -v -f "/backups/sportschool_backup_$(date +%Y%m%d).backup" database_name
```

#### 2. **Физическое резервное копирование с помощью `pg_basebackup`:**
```bash
pg_basebackup -U username -D /path/to/backup -Ft -z -P
```

#### 3. **Архивирование WAL-журналов:**
Настройте архивирование WAL-журналов в файл `postgresql.conf`:
```conf
archive_mode = on
archive_command = 'cp %p /path/to/archive/%f'
```

#### 4. **Проверка восстановления:**
Регулярно тестировать восстановление из резервных копий для обеспечения их работоспособности.

---


[Вернуться к содержанию](#content)

#### <a id="physical_structure">Физическая структура базы данных</a>  

![image](https://github.com/user-attachments/assets/00f1e781-29c7-4a07-ad39-289340cfbdb3)


### <a id="conclusion">Заключение</a>

#### Обобщение результатов
В ходе выполнения курсовой работы была разработана база данных для торговой организации, которая обеспечивает автоматизацию процессов учёта и анализа данных. База данных включает таблицы для хранения информации о товарах, клиентах, поставщиках и продажах, а также механизмы для управления целостностью данных и оптимизации производительности.Ключевые результаты и выводы:  
 
---

#### **1. Анализ предметной области**  
Проведён анализ бизнес-процессов, связанных с управлением товарами, поставками, клиентскими заказами и инвентарём. Выявлены ключевые сущности:   
- **Товары** (`products`) — каталог с атрибутами (цвет, размер, цена).  
- **Инвентарь** (`inventory`) — отслеживание остатков.  
- **События** (`events`) — логирование операций (поступление, списание, продажа).  
- **Клиенты** (`customers`) и их активность (корзина, избранное, история покупок).  

---

#### **2. Проектирование и реализация БД**  
- **Логическая структура**:  
  - Связи через внешние ключи (например, `products.supplier_id → suppliers.supplier_id`).  
- **Физическая реализация**:  
  - Использование типов данных PostgreSQL (например, `NUMERIC(10,2)` для цен).  
  - Автоматические последовательности (`SEQUENCE`) для генерации ID.  
  - Триггеры для обновления `last_updated` в `inventory`.  

---

#### **3. Реализация функционала**  
- **Интерфейс на PySide6** обеспечивает:  
  - **Администраторам**:  
    - Полный контроль над всеми таблицами (CRUD-операции).  
    - Управление ролями через таблицу `users` (тип `user_role`).  
  - **Поставщикам**:  
    - Регистрацию событий (`events`) с автоматическим пересчётом остатков (`quantity_in_stock`).  
    - Фильтрацию товаров по `supplier_id`.  
  - **Клиентам**:  
    - Работу с корзиной (`shopping_cart`) и оформление заказов (`sales`).  
    - Просмотр каталога товаров с фильтрацией по типу (`product_type`) и цвету.  

---

#### **4. Безопасность и доступ**  
- **Ролевая модель**:  
  - Администратор: полный доступ через `AdminWindow`.  
  - Поставщик: ограниченный доступ к своим товарам и событиям (`SupplierWindow`).  
  - Клиент: только личные данные (`CustomerWindow`).  
- **Защита данных**:  
  - Хэширование паролей (`sha256`).  
  - Параметризованные SQL-запросы для предотвращения инъекций.  
  - Ограничения на уровне БД (например, `CHECK (quantity_in_stock >= 0)`).  

---

#### **5. Тестирование и документация**  
- **Проверка корректности**:  
  - Обновление инвентаря при добавлении событий (например, списание уменьшает `quantity_in_stock`).  
  - Каскадное удаление записей (например, удаление пользователя → удаление связанного клиента).  
- **Документация**:  
  - SQL-дамп (`inventorybd.sql`) с полной схемой и тестовыми данными.  
  - Руководство пользователя в коде (логика интерфейса в `main.py`).  

---

**Общий Итог**: Разработанная система автоматизирует ключевые процессы управления инвентарём и продажами, обеспечивая гибкость для разных ролей пользователей. Готовое решение может быть внедрено в малом и среднем бизнесе для оптимизации логистики и повышения эффективности работы с клиентами.
Основные преимущества разработанной базы данных:
1. **Автоматизация учёта:** Устраняет ручной ввод данных и минимизирует ошибки.
2. **Аналитические возможности:** Предоставляет инструменты для анализа продаж, запасов и клиентов.
3. **Безопасность данных:** Реализованы механизмы авторизации, разграничения прав и резервного копирования.

#### Перспективы развития
Дальнейшее развитие базы данных может включать:
1. **Интеграция с CRM-системами:** Для более эффективной работы с клиентами.
2. **Добавление модуля прогнозирования спроса:** На основе анализа исторических данных.
3. **Оптимизация производительности:** Добавление партиционирования таблиц и использования материализованных представлений.
4. **Разработка мобильного приложения:** Для удобного доступа к данным через смартфоны.

В ходе выполнения данной курсовой работы была разработана база данных для спортивной школы, обеспечивающая хранение и управление данными о спортсменах, тренерах, соревнованиях и инвентаре. Данная база данных является важным инструментом для упрощения процессов управления информацией и аналитики в организации.

[Вернуться к содержанию](#content)

### <a id="literature">Список использованных информационных источников</a>

1. **Официальная документация:**  
   - **PostgreSQL**:  
     [Документация PostgreSQL](https://www.postgresql.org/docs/) — использовалась для проектирования структуры БД, работы с типами данных (`user_role`, `NUMERIC`), ограничениями целостности и триггерами.  
   - **PySide6 (Qt для Python)**:  
     [Руководство по PySide6](https://doc.qt.io/qtforpython-6/) — реализация GUI, работа с виджетами (`QTableWidget`, `QComboBox`), стилизация через QSS.  
   - **Psycopg2**:  
     [Документация Psycopg2](https://www.psycopg.org/docs/) — подключение к PostgreSQL, выполнение параметризованных запросов для предотвращения SQL-инъекций.  
   - **Python hashlib**:  
     [Документация hashlib](https://docs.python.org/3/library/hashlib.html) — реализация хэширования паролей (SHA-256) для таблицы `users`.  

2. **Архитектура БД и безопасность:**  
   - **Ролевая модель доступа**:  
     Реализация на основе типа `user_role` (ENUM: Администратор, Поставщик, Клиент) с ограничением прав через интерфейс (`AdminWindow`, `SupplierWindow`, `CustomerWindow`).  
   - **Нормализация данных**:  
     Таблицы `products`, `suppliers`, `inventory` спроектированы в соответствии с 3НФ (исключены транзитивные зависимости, разделены сущности).  

3. **Практические руководства:**  
   - **Работа с PostgreSQL в Python**:  
     [Примеры использования Psycopg2](https://www.psycopg.org/docs/usage.html) — интеграция БД с GUI, обработка транзакций.  
   - **Qt Style Sheets (QSS)**:  
     [Справочник по стилизации Qt](https://doc.qt.io/qt-6/stylesheet-syntax.html) — оформление интерфейса (файл `stype.qss`).  

4. **Тестирование и отладка:**  
   - **DBeaver**:  
     [Официальный сайт](https://dbeaver.io/) — визуализация структуры БД, проверка связей и данных.  
   - **Логирование событий**:  
     Таблица `events` с полями `event_type` (поступление, списание, продажа) для отслеживания изменений в инвентаре. 

[Вернуться к содержанию](#content)


Руководитель работы __________________ И. В. Пунгин

Задание принял к исполнению _______________________________ Лыткин Семён Васильевич
